'use strict';

var alpha = require('@backstage/plugin-catalog-node/alpha');
var pluginPermissionNode = require('@backstage/plugin-permission-node');
var zod = require('zod');

const hasLabel = pluginPermissionNode.createPermissionRule({
  name: "HAS_LABEL",
  description: "Allow entities with the specified label",
  resourceRef: alpha.catalogEntityPermissionResourceRef,
  paramsSchema: zod.z.object({
    label: zod.z.string().describe("Name of the label to match on")
  }),
  apply: (resource, { label }) => !!resource.metadata.labels?.hasOwnProperty(label),
  toQuery: ({ label }) => ({
    key: `metadata.labels.${label}`
  })
});

exports.hasLabel = hasLabel;
//# sourceMappingURL=hasLabel.cjs.js.map
